{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\tebie\\\\Documents\\\\fantasix-draft\\\\frontend v2\\\\src\\\\components\\\\Draft.js\",\n  _s = $RefreshSig$();\n// src/components/Draft.js\n\nimport React, { useState, useEffect } from 'react';\nimport TeamCard from \"./ui/TeamCard\";\nimport Select from 'react-select';\nimport { useFantasy } from '../context/FantasyContext';\nimport api from '../services/api';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function DraftScreen() {\n  _s();\n  const {\n    players,\n    setPlayers,\n    participants,\n    setParticipants,\n    teams,\n    setTeams\n  } = useFantasy();\n  const [selectedParticipant, setSelectedParticipant] = useState(null);\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        const [teamsResponse, playersResponse, participantsResponse, picksResponse] = await Promise.all([api.fetchTeams(), api.fetchPlayers(), api.fetchParticipants(), api.fetchPicks()]);\n\n        // Actualizar estados de equipos, jugadores, y participantes\n        setTeams(teamsResponse.data);\n        setPlayers(playersResponse.data);\n        const participantsWithPicks = participantsResponse.data.map(participant => {\n          const picks = picksResponse.data.filter(pick => pick.participant_id === participant.id);\n          return {\n            ...participant,\n            picks: picks.length > 0 ? picks.map(pick => ({\n              playerId: pick.player_id,\n              pickOrder: pick.pick_order\n            })) : []\n          };\n        });\n        setParticipants(participantsWithPicks);\n      } catch (error) {\n        console.error('Error fetching data:', error);\n      }\n    };\n    fetchData();\n  }, [setTeams, setPlayers, setParticipants]);\n\n  // Function to select a player for a participant\n  const selectPlayer = async player => {\n    if (player.selected || !selectedParticipant) return;\n    try {\n      const participant = participants.find(p => p.id === selectedParticipant);\n      if (!participant) {\n        alert('No participant selected');\n        return;\n      }\n      if (participant.picks.length >= 5) {\n        alert('El participante ya tiene 5 jugadores seleccionados');\n        return;\n      }\n      const newPickOrder = participant.picks.length + 1;\n\n      // Actualiza el estado en el frontend\n      setPlayers(players.map(p => p.id === player.id ? {\n        ...p,\n        selected: true,\n        selectedBy: selectedParticipant\n      } : p));\n      setParticipants(participants.map(p => p.id === selectedParticipant ? {\n        ...p,\n        picks: [...p.picks, {\n          playerId: player.id,\n          pickOrder: newPickOrder\n        }]\n      } : p));\n\n      // Guardar la selección en la base de datos\n      await api.pickPlayer(selectedParticipant, player.id, newPickOrder);\n    } catch (error) {\n      console.error(\"Error selecting player:\", error);\n    }\n  };\n\n  // Function to render team card\n  const renderTeam = team => {\n    const teamPlayers = players.filter(player => player.team_id === team.id);\n    return /*#__PURE__*/_jsxDEV(TeamCard, {\n      team: team,\n      players: teamPlayers,\n      onSelect: selectPlayer // Aquí usamos selectPlayer, que ahora está definida antes.\n    }, team.id, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this);\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"draft-screen\",\n    children: [/*#__PURE__*/_jsxDEV(Select, {\n      options: participants.map(participant => ({\n        value: participant.id,\n        label: participant.name\n      })),\n      onChange: selectedOption => setSelectedParticipant(selectedOption ? selectedOption.value : null),\n      placeholder: \"Seleccionar participante\",\n      isClearable: true\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"teams-container\",\n      children: teams.map(team => renderTeam(team))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 87,\n    columnNumber: 5\n  }, this);\n}\n_s(DraftScreen, \"5jEas+Cx1bfPv6letY4KLFEVcM4=\", false, function () {\n  return [useFantasy];\n});\n_c = DraftScreen;\nvar _c;\n$RefreshReg$(_c, \"DraftScreen\");","map":{"version":3,"names":["React","useState","useEffect","TeamCard","Select","useFantasy","api","jsxDEV","_jsxDEV","DraftScreen","_s","players","setPlayers","participants","setParticipants","teams","setTeams","selectedParticipant","setSelectedParticipant","fetchData","teamsResponse","playersResponse","participantsResponse","picksResponse","Promise","all","fetchTeams","fetchPlayers","fetchParticipants","fetchPicks","data","participantsWithPicks","map","participant","picks","filter","pick","participant_id","id","length","playerId","player_id","pickOrder","pick_order","error","console","selectPlayer","player","selected","find","p","alert","newPickOrder","selectedBy","pickPlayer","renderTeam","team","teamPlayers","team_id","onSelect","fileName","_jsxFileName","lineNumber","columnNumber","className","children","options","value","label","name","onChange","selectedOption","placeholder","isClearable","_c","$RefreshReg$"],"sources":["C:/Users/tebie/Documents/fantasix-draft/frontend v2/src/components/Draft.js"],"sourcesContent":["// src/components/Draft.js\r\n\r\nimport React, { useState, useEffect } from 'react';\r\nimport TeamCard from \"./ui/TeamCard\";\r\nimport Select from 'react-select';\r\nimport { useFantasy } from '../context/FantasyContext';\r\nimport api from '../services/api';\r\n\r\nexport default function DraftScreen() {\r\n  const { players, setPlayers, participants, setParticipants, teams, setTeams } = useFantasy();\r\n  const [selectedParticipant, setSelectedParticipant] = useState(null);\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      try {\r\n        const [teamsResponse, playersResponse, participantsResponse, picksResponse] = await Promise.all([\r\n          api.fetchTeams(),\r\n          api.fetchPlayers(),\r\n          api.fetchParticipants(),\r\n          api.fetchPicks(),\r\n        ]);\r\n\r\n        // Actualizar estados de equipos, jugadores, y participantes\r\n        setTeams(teamsResponse.data);\r\n        setPlayers(playersResponse.data);\r\n\r\n        const participantsWithPicks = participantsResponse.data.map(participant => {\r\n          const picks = picksResponse.data.filter(pick => pick.participant_id === participant.id);\r\n          return {\r\n            ...participant,\r\n            picks: picks.length > 0 ? picks.map(pick => ({ playerId: pick.player_id, pickOrder: pick.pick_order })) : []\r\n          };\r\n        });\r\n\r\n        setParticipants(participantsWithPicks);\r\n      } catch (error) {\r\n        console.error('Error fetching data:', error);\r\n      }\r\n    };\r\n\r\n    fetchData();\r\n  }, [setTeams, setPlayers, setParticipants]);\r\n\r\n  // Function to select a player for a participant\r\n  const selectPlayer = async (player) => {\r\n    if (player.selected || !selectedParticipant) return;\r\n\r\n    try {\r\n      const participant = participants.find(p => p.id === selectedParticipant);\r\n      if (!participant) {\r\n        alert('No participant selected');\r\n        return;\r\n      }\r\n\r\n      if (participant.picks.length >= 5) {\r\n        alert('El participante ya tiene 5 jugadores seleccionados');\r\n        return;\r\n      }\r\n\r\n      const newPickOrder = participant.picks.length + 1;\r\n\r\n      // Actualiza el estado en el frontend\r\n      setPlayers(players.map(p => p.id === player.id ? { ...p, selected: true, selectedBy: selectedParticipant } : p));\r\n      setParticipants(participants.map(p => p.id === selectedParticipant ? { ...p, picks: [...p.picks, { playerId: player.id, pickOrder: newPickOrder }] } : p));\r\n\r\n      // Guardar la selección en la base de datos\r\n      await api.pickPlayer(selectedParticipant, player.id, newPickOrder);\r\n    } catch (error) {\r\n      console.error(\"Error selecting player:\", error);\r\n    }\r\n  };\r\n\r\n  // Function to render team card\r\n  const renderTeam = (team) => {\r\n    const teamPlayers = players.filter(player => player.team_id === team.id);\r\n    return (\r\n      <TeamCard\r\n        key={team.id}\r\n        team={team}\r\n        players={teamPlayers}\r\n        onSelect={selectPlayer} // Aquí usamos selectPlayer, que ahora está definida antes.\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <div className=\"draft-screen\">\r\n      {/* Selector de participantes */}\r\n      <Select\r\n        options={participants.map(participant => ({\r\n          value: participant.id,\r\n          label: participant.name\r\n        }))}\r\n        onChange={(selectedOption) => setSelectedParticipant(selectedOption ? selectedOption.value : null)}\r\n        placeholder=\"Seleccionar participante\"\r\n        isClearable\r\n      />\r\n      {/* Area para mostrar los equipos */}\r\n      <div className=\"teams-container\">\r\n        {teams.map((team) => renderTeam(team))}\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}